var ProfileAddController = function () {    var regexPassword = /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)([-+!*$@%_\w]{6,15})$/;    var regexPhone = /^0[1-9]([0-9]){8}$/;    var regexEmail = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;    var emailValid = false, loginValid = false;    var messagePassword = "Le mot de passe doit comporter au moins 6 caractères, dont un chiffre ou des " +        "caractères spéciaux (-+!*$@%_), une lettre en majuscule et en miniscule";    var $inputLogin = $("#fos_user_registration_form_username");    var $inputEmail = $("#fos_user_registration_form_email");    var validationForm = function () {        // for more info visit the official plugin documentation:         // http://docs.jquery.com/Plugins/Validation        var form = $('#form_validation_create');        var error = $('.alert-danger', form);        var success = $('.alert-success', form);        var alertMessage = function (field, message) {            $(field).closest('.form-group').addClass('has-error');            form.find('#message-alert').find('.message-error').html(message);            App.scrollTo(error, -200);        }        form.validate({            errorElement: 'span', //default input error message container            errorClass: 'help-block help-block-error', // default input error message class            focusInvalid: false, // do not focus the last invalid input            ignore: "",  // validate all fields including form hidden input            messages: {                select_multi: {                    maxlength: jQuery.validator.format("Max {0} items allowed for selection"),                    minlength: jQuery.validator.format("At least {0} items must be selected")                }            },            rules: {                name: {                    minlength: 2,                    required: true                },                input_group: {                    email: true,                    required: true                },                email: {                    required: true,                    email: true                },                url: {                    required: true,                    url: true                },                number: {                    required: true,                    number: true                },                digits: {                    required: true,                    digits: true                },                creditcard: {                    required: true,                    creditcard: true                },                occupation: {                    minlength: 5,                },                select: {                    required: true                },            },            invalidHandler: function (event, validator) { //display error alert on form submit                              success.hide();                error.show();                $('.message-error').html('Veuillez remplire tous les champs obligatoires.');                App.scrollTo(error, -200);            },            errorPlacement: function (error, element) { // render error placement for each input type                var cont = $(element).parent('.input-group');                if (cont) {                    cont.after(error);                } else {                    element.after(error);                }            },            highlight: function (element) { // hightlight error inputs                $(element)                    .closest('.form-group').addClass('has-error'); // set error class to the control group            },            unhighlight: function (element) { // revert the change done by hightlight                $(element)                    .closest('.form-group').removeClass('has-error'); // set error class to the control group            },            success: function (label) {                label                    .closest('.form-group').removeClass('has-error'); // set success class to the control group            },            submitHandler: function (form) {                if (!loginValid) {                    success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_username', "Ce login est déjà utilisé pour un autre compte.")                } else if (!regexEmail.test($.trim($inputEmail.val()))) {                    success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_email', "Veuillez saisir une adresse valide.");                } else if (regexEmail.test($.trim($inputEmail.val())) && !emailValid) {                    success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_email', "Cette adresse mail est déjà utilisée pour un autre compte.");                }                else if (!regexPassword.test($.trim($('#fos_user_registration_form_plainPassword_first').val()))) {                    console.log($('#fos_user_registration_form_plainPassword_first').val());                    console.log(regexPassword.test($.trim($('#fos_user_registration_form_plainPassword_first').val())));                                        success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_plainPassword_first', messagePassword);                } else if ($.trim($('#fos_user_registration_form_plainPassword_second').val()) != $.trim($('#fos_user_registration_form_plainPassword_first').val())) {                    success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_plainPassword_second', "Veuillez confirmer votre nouveau mot de passe..");                } else if (!regexPhone.test($.trim($("#fos_user_registration_form_phone").val())) && $("#fos_user_registration_form_phone").val()) {                    success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_phone', "Veuillez saisir un numéro de téléphone valide.");                } else if (!regexPhone.test($.trim($("#fos_user_registration_form_homePhone").val())) && $("#fos_user_registration_form_homePhone").val()) {                    success.hide();                    error.show();                    alertMessage('#fos_user_registration_form_homePhone', "Veuillez saisir un numéro de téléphone valide.");                } else {                    success.show();                    error.hide();                    form.submit();                }                // submit the form            }        });    }    var tooltipPassword = function () {        $('#fos_user_registration_form_plainPassword_first,#fos_user_registration_form_plainPassword_second').tooltip({            'trigger': 'focus',            placement: "top",            'title': messagePassword        });    }    var checkLogin = function () {        $inputLogin.change(function () {            console.log('Test');            var login = $.trim($(this).val());            var $formGroup = $(this).closest('.form-group');            if (login.length < 3) {                loginValid = false;                $formGroup.find('.login-valid')                    .removeClass("display-hide")                    .html("Le login doit être supérieur à 3.");                $formGroup.addClass('has-error');            } else {                var href = Routing.generate("app_user_check_username_or_email");                $.getJSON(href, {"user": login}).done(function (data) {                    console.log(data);                    if (data.type == "success" && data.response == false) {                        loginValid = true;                        $formGroup.removeClass('has-error');                        $formGroup.find('.message-error').addClass("display-hide");                    } else {                        loginValid = false;                        $formGroup.find('.message-error')                            .removeClass("display-hide").html("Existe Déjà");                        $formGroup.addClass('has-error');                    }                });            }        });    }    var checkMail = function () {        $inputEmail.keyup(function () {            var email = $(this).val();            var $formGroup = $(this).closest('.form-group');            if (regexEmail.test(email)) {                var href = Routing.generate('app_user_check_username_or_email');                $.getJSON(href, {"user": email}).done(function (data) {                    console.log(data);                    if (data.type == "success" && data.response == false) {                        emailValid = true;                        $formGroup.removeClass('has-error');                        $formGroup.find('.message-error').addClass("display-hide");                    } else {                        emailValid = false;                        $formGroup.find('.message-error')                            .removeClass("display-hide").html("Existe Déjà");                        $formGroup.addClass('has-error');                    }                });            } else {                emailValid = false;                $formGroup.find('.message-error')                    .removeClass("display-hide").html("");  //Adresse mail non valide                $formGroup.addClass('has-error');            }        });    }    return {        init: function () {            validationForm();            checkLogin();            tooltipPassword();            checkMail();        }    }}();$(function () {    ProfileAddController.init();});